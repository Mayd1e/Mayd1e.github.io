<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[Android中使用代码模拟点击,触发点击事件.]]></title>
      <url>http://www.lianyanshan.com/2016/04/15/Android%E4%B8%AD%E4%BB%A3%E7%A0%81%E6%A8%A1%E6%8B%9F%E7%82%B9%E5%87%BB/</url>
      <content type="html"><![CDATA[<center><h4>Android中使用代码模拟点击,触发点击事件</h4></center>

<p>有时候我们项目界面中往往会有一个返回按钮,当我们给这个返回按钮写好点击事件后</p>
<p>这时候,想要按下手机的返回键,触发的事件和点击界面中的返回按钮是一样的话</p>
<p>我们可以使用模拟点击:</p>
<a id="more"></a>
<p>官方提供的API:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">View.performClick();</span><br></pre></td></tr></table></figure></p>
<p>先看看performClick()源码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">performClick</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="keyword">boolean</span> result;</span><br><span class="line">    <span class="keyword">final</span> ListenerInfo li = mListenerInfo;</span><br><span class="line">    <span class="keyword">if</span> (li != <span class="keyword">null</span> &amp;&amp; li.mOnClickListener != <span class="keyword">null</span>) &#123;</span><br><span class="line">        playSoundEffect(SoundEffectConstants.CLICK);</span><br><span class="line">        li.mOnClickListener.onClick(<span class="keyword">this</span>);</span><br><span class="line">        result = <span class="keyword">true</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        result = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    sendAccessibilityEvent(AccessibilityEvent.TYPE_VIEW_CLICKED);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看出只有设置了监听器view.setOnClickListener,才会触发View.performClick();</p>
<p>例如:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> Button button;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">		setContentView(R.layout.activity_main);</span><br><span class="line">		button = (Button)findViewById(R.id.button);</span><br><span class="line">		</span><br><span class="line">		button.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">			<span class="meta">@Override</span></span><br><span class="line">			<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>&#123;</span><br><span class="line">				Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"按钮点击了"</span>, <span class="number">0</span>).show();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">//重写手机返回键事件</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onBackPressed</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		button.performClick(); <span class="comment">//模拟按钮点击</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android Studio下百度地图定位162错误]]></title>
      <url>http://www.lianyanshan.com/2016/04/12/Android%20Studio%E4%B8%8B%E7%99%BE%E5%BA%A6%E5%9C%B0%E5%9B%BE%E5%AE%9A%E4%BD%8D162%E9%94%99%E8%AF%AF/</url>
      <content type="html"><![CDATA[<center><h4>Android Studio下百度地图定位162错误</h4></center>

<p>今天给项目增加一个定位功能,使用百度地图定位sdk出现error code : 162的错误:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">error code : <span class="number">162</span></span><br><span class="line">latitude : <span class="number">4.9E-324</span></span><br><span class="line">lontitude : <span class="number">4.9E-324</span></span><br><span class="line">radius : <span class="number">0.0</span></span><br><span class="line">locationdescribe : <span class="keyword">null</span></span><br></pre></td></tr></table></figure>
<a id="more"></a>
<p>官方解释:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">162</span>： 请求串密文解析失败，一般是由于客户端SO文件加载失败造成，请严格参照开发指南或demo开发，放入对应SO文件。</span><br></pre></td></tr></table></figure></p>
<p>仔细看了下so都有放,目录也正确.百度找答案,找半天都是说so文件没放…</p>
<p>后面仔细一想,这个项目原来没有使用过JNI,而Android加载so库文件需要在build.gradle里加几句代码:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sourceSets &#123;</span><br><span class="line">    main &#123;</span><br><span class="line">        jniLibs.srcDirs = [<span class="string">'libs'</span>]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>好吧…问题解决了..</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Android中ListView异常cannot be cast to android.widget.HeaderViewListAdapter]]></title>
      <url>http://www.lianyanshan.com/2016/04/06/Android%E4%B8%ADListView%E5%BC%82%E5%B8%B8cannot%20be%20cast%20to%20android.widget.HeaderViewListAdapter/</url>
      <content type="html"><![CDATA[<center><h4>Android中ListView异常cannot be cast to android.widget.HeaderViewListAdapter</h4></center>

<p>用listview设置header或footerview，通常发生该异常。</p>
<p>如果你没有发生，那是碰巧。但是你可能不知道原因。</p>
<a id="more"></a>
<p>如果在listview.setAdapter（adapter）方法之后 添加头或尾view，</p>
<p>即addHeaderView或 addFooterView，</p>
<p>那么在你listView.removeHearderView或removeFooterView时就会报该异常。</p>
<p>在Listview的源码中如果设置了adapter，那么它会强转成HeaderViewListAdapter，所以就会报错。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (mAdapter != <span class="keyword">null</span> &amp;&amp; ((HeaderViewListAdapter) mAdapter).removeHeader(v)) &#123;</span><br><span class="line">	<span class="keyword">if</span> (mDataSetObserver != <span class="keyword">null</span>) &#123;</span><br><span class="line">		mDataSetObserver.onChanged();</span><br><span class="line">	&#125;</span><br><span class="line">	result = <span class="keyword">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>所以你一定要在setAdapter之前调用addHeaderView或addFooterVeiw.</p>
]]></content>
    </entry>
    
    <entry>
      <title><![CDATA[Hello World]]></title>
      <url>http://www.lianyanshan.com/2016/04/05/hello-world/</url>
      <content type="html"><![CDATA[<center><h3>Welcome to <a href="http://www.lianyanshan.com/">Morphine</a>!</h3> </center>]]></content>
    </entry>
    
  
  
</search>
